import{k as A,r as c,j as e,c as T,_ as S,d as I}from"./index-BMh66HCr.js";import{c as q}from"./clsx-B-dksMZM.js";import{P as b}from"./plus-BS9_eBA4.js";import{X as R}from"./x-BzdX7HG_.js";import{a as _,u as D,F as P}from"./index.esm-ClWcd2Qo.js";import{E as j}from"./ErrorMsg-1cl8sRVV.js";const C=({setImageSelect:f})=>{const[o,u]=c.useState([]),p=c.useRef(),m=c.useRef();c.useEffect(()=>{const s=m.current,a=p.current,t=()=>{a.click()};return s==null||s.addEventListener("click",t),()=>{s==null||s.removeEventListener("click",t)}},[]);const h=s=>{const a=s.target.files;for(let t=0;t<a.length;t++){const l=new FileReader;l.readAsDataURL(a[t]),l.onload=x=>{u(r=>[...r,x.target.result]),f(r=>[...r,a[t]])}}};return e.jsxs("div",{className:"flex justify-center",children:[e.jsx("div",{className:q({hidden:o.length}),children:e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:m,className:"flex justify-center items-center h-[350px] sm:h-[450px] w-[350px] sm:w-[450px] rounded-lg bg-black-black/5",children:e.jsx(b,{})}),e.jsx("input",{ref:p,multiple:!0,className:"hidden",type:"file",onChange:h})]})}),e.jsx("div",{className:q("flex w-[400px]",{hidden:!o.length}),children:e.jsx("div",{className:"relative flex justify-center h-[400px]",children:o.map((s,a)=>e.jsx("div",{style:{left:a*25,bottom:a*5},className:"absolute ",children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{onClick:()=>{u(t=>{const l=t.filter(x=>x!=s);return l.push(s),l})},children:e.jsx("div",{className:" h-[350px] sm:h-[420px] w-[350px] sm:w-[420px] rounded-lg relative ",children:e.jsx("img",{src:s,className:"w-full h-full object-contain",alt:""})})}),a==(o==null?void 0:o.length)-1&&e.jsx("button",{onClick:()=>{u(t=>t.filter((x,r)=>r!==a)),f(t=>t==null?void 0:t.filter((x,r)=>r!==a))},className:"absolute top-2 right-2 hidden group-hover:block",children:e.jsx(R,{})})]})},s))})})]})};C.propTypes={setImageSelect:A.func};const L=()=>{var h;const[f,o]=c.useState([]),{register:u,formState:{errors:p}}=_(),m=c.useCallback(async()=>{try{const{data:s}=await T.get("/api/store/category?fields=name");o(s.categories),console.log(s)}catch(s){console.error(s)}},[]);return c.useEffect(()=>{m()},[m]),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{...u("category",{required:"This field is required"}),className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"number",children:[e.jsx("option",{value:"",children:"Category"}),f.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]}),e.jsx(j,{message:(h=p==null?void 0:p.category)==null?void 0:h.message})]})},X=()=>{var y,w,N,v;const[f,o]=c.useState([]),[u,p]=c.useState(1),[m,h]=c.useState(1),[s,a]=c.useState(!1),t=D(),{register:l,handleSubmit:x,formState:{errors:r}}=t,E=x(async i=>{var d,k;try{a(!0);const n=new FormData;f.forEach(g=>{n.append("imgs",g)}),i.ingredient.forEach(g=>{n.append("ingredient",g)}),i.warning.forEach(g=>{n.append("warning",g)}),n.append("title",i.title),n.append("price",i.price),n.append("description",i.description),n.append("rating",i.rating),n.append("quantity",i.quantity),n.append("useTo",i.useTo),n.append("category",i.category);const F=await T.post("/api/store/product",n);S.success(F.data.message),window.location.reload(),a(!1)}catch(n){S.error(((k=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:k.message)||"There is an Error"),a(!1),console.error(n)}});return e.jsxs("div",{className:"pcontainer py-20 w-full overflow-x-auto",children:[e.jsx(C,{setImageSelect:o}),e.jsx("div",{className:"flex justify-center",children:e.jsx(P,{...t,children:e.jsxs("form",{onSubmit:E,className:"w-[350px] sm:w-[450px] py-5",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("input",{...l("title",{required:"This field is required"}),placeholder:"Title",className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"text"}),e.jsx(j,{message:(y=r==null?void 0:r.title)==null?void 0:y.message})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("textarea",{...l("description",{required:"This field is required"}),placeholder:"Description",className:"w-full py-2 px-2 min-h-32 max-h-44 rounded-md outline-none border focus:border-blue-500",type:"text"}),e.jsx(j,{message:(w=r==null?void 0:r.description)==null?void 0:w.message})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("input",{...l("price",{required:"This field is required"}),placeholder:"Price",className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"number"}),e.jsx(j,{message:(N=r==null?void 0:r.price)==null?void 0:N.message})]}),e.jsx(L,{}),e.jsx("input",{...l("rating"),placeholder:"Rating",className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"number"}),e.jsx("input",{...l("quantity"),placeholder:"Quantity",className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"number"}),e.jsxs("div",{className:"w-full",children:[e.jsx("textarea",{...l("useTo",{required:"This field is required"}),placeholder:"Use to",className:"w-full py-2 px-2 min-h-32 max-h-44 rounded-md outline-none border focus:border-blue-500",type:"text"}),e.jsx(j,{message:(v=r==null?void 0:r.useTo)==null?void 0:v.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Warning"}),e.jsx("button",{onClick:i=>{i.preventDefault(),p(u+1)},children:e.jsx(b,{className:"size-5"})})]}),e.jsx("div",{className:"space-y-3",children:Array(u).fill().map((i,d)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-black-black/50"}),e.jsx("input",{...l(`warning.${d}`),placeholder:"warning number "+(d+1),className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"text"})]},d))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Ingredient"}),e.jsx("button",{onClick:i=>{i.preventDefault(),h(m+1)},children:e.jsx(b,{className:"size-5"})})]}),e.jsx("div",{className:"space-y-3",children:Array(m).fill().map((i,d)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-black-black/50"}),e.jsx("input",{...l(`ingredient.${d}`),placeholder:"Ingredient number "+(d+1),className:"w-full py-2 px-2 rounded-md outline-none border focus:border-blue-500",type:"text"})]},d))})]})]}),e.jsx("button",{disabled:s,className:"w-full bg-blue-500 text-white-White hover:bg-blue-600 disabled:bg-blue-300 mt-3 py-2 rounded-md flex justify-center",children:s?e.jsx(I,{className:"animate-spin"}):"Create"})]})})})]})};export{X as default};
